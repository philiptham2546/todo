(()=>{"use strict";const e=()=>{const e=document.getElementById("cat_input"),n=document.getElementById("cat_desc");if(""===e.value)return void alert("Warning, cannot leave category name blank!");const d=c(e.value.replace(/ /g,"_"),n.value,[]);a(d),t(),e.value="",n.value="",t()},t=()=>{const e=document.querySelectorAll("article"),t=document.getElementById("cat_select"),n=document.getElementById("catList");t.innerHTML="",n.innerHTML="";for(let a of e){const e=document.createElement("option");e.value=a.id,e.text=a.id.replace(/_/g," "),t.appendChild(e);const d=document.createElement("li");d.textContent=a.id.replace(/_/g," "),d.style.textAlign="left",n.appendChild(d)}},n=()=>{const e=document.getElementById("cat_select"),t=document.getElementById("item_input_name"),n=document.getElementById("item_input_due"),a=document.getElementById("priority_select"),d=document.getElementById("panel_notes_input");if(""===e.value||""===t.value||""===n.value||""===a.value)return void alert("Warning, cannot leave category, name, due date, and priority level blank!");const c=function(e,t,n,a){return{name:e,due_date:t,priority:n,notes:a}}(t.value.replace(/ /g,"_"),n.value,a.value,d.value);l(e.value,c),o(e.value),t.value="",n.value="",a.value="",e.value="",d.value=""},a=e=>{const n=document.getElementById("content"),a=document.createElement("article");a.id=e.cat_name;const c=document.createElement("div");c.classList.add("btn_div");const l=document.createElement("button");l.textContent="X",l.classList.add("del_btn"),l.classList.add("ctrl_btn"),l.addEventListener("click",(()=>{n.removeChild(a),t();const d=JSON.parse(localStorage.getItem("arr"));let c=!1;for(let t=0;t<d.length;t++)if(d[t].cat_name===e.cat_name){d.splice(t,1),c=!0;break}c||alert("ERROR"),localStorage.setItem("arr",JSON.stringify(d))})),c.appendChild(l);const o=document.createElement("h2"),i=document.createElement("button"),r=document.createElement("p"),p=document.createElement("table");o.textContent=e.cat_name.replace(/_/g," "),""===e.cat_desc?r.textContent="Description here!":r.textContent=e.cat_desc,p.innerHTML="\n        <thead>\n            <tr>\n                <th>Item</th>\n                <th>Due date</th>\n                <th>Edit due date</th>\n                <th>Priority level</th>\n                <th>Edit priority level</th>\n                <th>Delete</th>\n            </tr>\n        </thead>\n        <tbody></tbody>\n    ",o.addEventListener("click",(e=>{o.style.cursor="pointer",function(e){const n=document.getElementById(e),a=JSON.parse(n.dataset.catObj),d=n.querySelector("h2");let c=prompt("What's this category going to be called?");null!==c&&""!==c.trim()?(d.textContent=c,c=c.replace(/ /g,"_"),a.cat_name=c,n.dataset.catObj=JSON.stringify(a),n.id=c,function(e,n){const a=window.localStorage,d=JSON.parse(a.getItem("arr"))||[],c=document.getElementById(n),l=JSON.parse(c.dataset.catObj);for(let t=0;t<d.length;t++)if(d[t].cat_name===e){d[t]=l;break}a.setItem("arr",JSON.stringify(d)),t()}(e,c)):alert("Category name cannot be empty!")}(e.target.parentNode.id)})),r.addEventListener("click",(e=>{r.style.cursor="pointer",function(e){const t=document.getElementById(e),n=JSON.parse(t.dataset.catObj),a=t.querySelector("p");let d=prompt("What's your new category description going to be?");a.textContent=d,n.cat_desc=d,t.dataset.catObj=JSON.stringify(n),m(e)}(e.target.parentNode.id)})),i.classList.add("size_btn"),i.classList.add("min"),i.classList.add("ctrl_btn"),i.textContent="-",i.addEventListener("click",s),c.appendChild(i),a.appendChild(c),a.appendChild(o),a.appendChild(r),a.appendChild(p),n.append(a);const u=document.createElement("button");u.classList.add("ctrl_btn"),u.classList.add("order_btn"),u.textContent="<",u.addEventListener("click",(e=>{d(e,!0)})),c.appendChild(u);const h=document.createElement("button");h.classList.add("ctrl_btn"),h.classList.add("order_btn"),h.textContent=">",h.addEventListener("click",(e=>{d(e,!1)})),c.appendChild(h),a.dataset.catObj=JSON.stringify(e),m(e.cat_name)};function d(e,n){const a=e.target.parentNode.parentNode,d=document.getElementById("content");let c=a.previousElementSibling,l=a.nextElementSibling;var o,i;d.removeChild(a),n?null===c?d.appendChild(a):d.insertBefore(a,c):null===l?d.insertBefore(a,d.firstElementChild):(o=a,(i=l).parentNode.insertBefore(o,i.nextSibling)),function(){const e=window.localStorage,t=document.querySelectorAll("#content > article"),n=[];for(let e of t){let t=JSON.parse(e.dataset.catObj);n.push(t)}e.setItem("arr",JSON.stringify(n))}(),t()}function c(e,t,n){return{cat_name:e,cat_desc:t,items:n}}const l=(e,t)=>{const n=document.getElementById(e),a=JSON.parse(n.dataset.catObj);a.items.push(t),n.dataset.catObj=JSON.stringify(a),m(e)},o=e=>{r(e);const t=document.getElementById(e),n=JSON.parse(t.dataset.catObj),a=document.querySelector(`#${e} > table > tbody`),d=n.items;a.innerHTML="";for(let t of d)i(e,t);m(e)};function i(e,t){const n=document.getElementById(e),a=JSON.parse(n.dataset.catObj),d=n.querySelector("table > tbody"),c=(a.items,document.createElement("tr"));c.classList.add(t.name.replace(/ /g,"_"));const l=document.createElement("td"),i=document.createElement("td"),r=document.createElement("td"),s=document.createElement("input"),p=document.createElement("button"),u=document.createElement("td"),h=document.createElement("td"),C=document.createElement("select"),b=document.createElement("button"),g=document.createElement("tr");g.id="notes_row",g.classList.add(t.name.replace(/ /g,"_"));const E=document.createElement("td");E.colSpan="5",E.style.textAlign="left",E.style.padding="5px";const y=document.createElement("div");y.textContent="Notes:";const _=document.createElement("div");_.textContent=t.notes,_.classList.add("text_box");const v=document.createElement("button");v.textContent="Edit",v.classList.add("saved"),v.classList.add("edit_btn"),E.appendChild(y),E.appendChild(document.createElement("br")),E.appendChild(_),E.appendChild(v),g.appendChild(E);const x=document.createElement("td");x.style.display="grid",x.style.justifyContent="center",x.style.alignItems="center";const f=document.createElement("button");f.classList.add("del_btn"),l.rowSpan="2",l.textContent=t.name.replace(/_/g," "),i.textContent=t.due_date,p.textContent="Change";let L="";switch(t.priority){case"0":L="Low";break;case"1":L="Medium";break;case"2":L="High"}u.textContent=L,f.textContent="X",s.type="date",s.classList.add("edit_due_input"),r.appendChild(s),r.appendChild(document.createElement("br")),r.appendChild(p),p.classList.add("edit_btn"),C.classList.add("edit_priority_select");const O=document.createElement("option");O.value=0,O.text="Low";const S=document.createElement("option");S.value=1,S.text="Medium";const N=document.createElement("option");switch(N.value=2,N.text="High",C.appendChild(O),C.appendChild(S),C.appendChild(N),b.textContent="Change",b.classList.add("edit_btn"),h.appendChild(C),h.appendChild(document.createElement("br")),h.appendChild(b),c.appendChild(l),c.appendChild(i),c.appendChild(r),c.appendChild(u),c.appendChild(h),x.appendChild(f),c.appendChild(x),d.appendChild(c),d.appendChild(g),t.priority){case"0":c.style.backgroundColor="rgb(183,215,168)",g.style.backgroundColor="rgb(183,215,168)";break;case"1":c.style.backgroundColor="rgb(249,203,156)",g.style.backgroundColor="rgb(249,203,156)";break;case"2":c.style.backgroundColor="rgb(234,153,153)",g.style.backgroundColor="rgb(234,153,153)"}f.addEventListener("click",(t=>{d.removeChild(c),d.removeChild(g);const l=JSON.parse(n.dataset.catObj).items;for(let e=0;e<l.length;e++)if(l[e].name===t.target.parentNode.parentNode.className){l.splice(e,1);break}a.items=l,n.dataset.catObj=JSON.stringify(a),m(e)})),p.addEventListener("click",(()=>{!function(e,t,n,a){const d=e.value;if(""===d)return void alert("Warning, cannot leave due date blank!");e.value="",n.textContent=d;const c=document.getElementById(t),l=JSON.parse(c.dataset.catObj),i=l.items;for(let e=0;e<i.length;e++)if(i[e].name===a){i[e].due_date=d;break}l.items=i,c.dataset.catObj=JSON.stringify(l),o(t)}(s,e,i,t.name)})),b.addEventListener("click",(()=>{!function(e,t,n,a){const d=e.value;if(""===new_due)return void alert("Warning, cannot leave due date blank!");e.value="";let c="";switch(d){case"0":c="Low";break;case"1":c="Medium";break;case"2":c="High"}n.textContent=c;const l=document.getElementById(t),i=JSON.parse(l.dataset.catObj),r=i.items;for(let e=0;e<r.length;e++)if(r[e].name===a){r[e].priority=d;break}i.items=r,l.dataset.catObj=JSON.stringify(i),o(t)}(C,e,u,t.name)})),v.addEventListener("click",(n=>{!function(e,t,n){const a=e.parentNode,d=document.getElementById(t),c=JSON.parse(d.dataset.catObj),l=c.items,i=a.querySelector(".text_box");if(console.log(i.textContent),console.log(e.textContent),e.classList.contains("saved")){console.log("got to start of eeditNotes saved handling"),e.classList.remove("saved"),e.textContent="Save";const t=document.createElement("textarea");t.rows="4",t.cols="80",t.value=i.textContent,t.classList.add("text_box"),a.insertBefore(t,i),a.removeChild(i)}else{e.classList.add("saved"),e.textContent="Edit";const r=document.createElement("div");r.textContent=i.value,r.classList.add("text_box"),a.insertBefore(r,i),a.removeChild(i);for(let e=0;e<l.length;e++)if(l[e].name===n){l[e].notes=r.textContent;break}d.dataset.catObj=JSON.stringify(c),o(t)}}(v,e,t.name)}))}const r=e=>{const t=document.getElementById(e),n=JSON.parse(t.dataset.catObj);n.items.sort(((e,t)=>{const n=new Date(e.due_date)-new Date(t.due_date);return 0===n?t.priority-e.priority:n})),t.dataset.catObj=JSON.stringify(n)},s=e=>{const t=e.target,n=t.parentNode.parentNode;if(t.classList.contains("min")){t.classList.remove("min"),t.classList.add("max"),t.textContent="+";const e=n.querySelector("table");n.removeChild(e)}else{t.classList.remove("max"),t.classList.add("min"),t.textContent="-";const e=document.createElement("table");e.innerHTML="\n        <thead>\n            <tr>\n                <th>Item</th>\n                <th>Due date</th>\n                <th>Edit due date</th>\n                <th>Priority level</th>\n                <th>Edit priority level</th>\n                <th>Delete</th>\n            </tr>\n        </thead>\n        <tbody></tbody>\n        ",n.appendChild(e),o(n.id)}};function m(e){const t=window.localStorage,n=JSON.parse(t.getItem("arr"))||[],a=document.getElementById(e),d=JSON.parse(a.dataset.catObj);let c=!1;for(let t=0;t<n.length;t++)if(n[t].cat_name===e){c=!0,n[t]=d;break}c||n.push(d),t.setItem("arr",JSON.stringify(n))}(()=>{(()=>{(()=>{const e=document.getElementById("panel"),t=document.createElement("div");t.style.padding="10px",t.id="catList_container";const n=document.createElement("h2");n.textContent="Categories active:",n.style.textAlign="left";const a=document.createElement("ul");a.style.textAlign="left",a.id="catList",t.appendChild(n),t.appendChild(a),e.insertBefore(t,document.getElementById("cat_container"))})();const t=document.getElementById("panel"),a=document.createElement("div");a.id="cat_container",a.style.position="sticky",a.style.padding="10px";const d=document.createElement("button");d.classList.add("add_button"),d.id="cat_button",d.textContent="Add new category!";const c=document.createElement("input");c.id="cat_input",c.type="text";const l=document.createElement("label");l.htmlFor="cat_input",l.textContent="Category name: ";const o=document.createElement("input");o.id="cat_desc",o.type="text";const i=document.createElement("label");i.htmlFor="cat_desc",i.textContent="Category description: ",d.addEventListener("click",e),a.appendChild(l),a.appendChild(document.createElement("br")),a.appendChild(c),a.appendChild(document.createElement("br")),a.appendChild(document.createElement("br")),a.appendChild(i),a.appendChild(document.createElement("br")),a.appendChild(o),a.appendChild(document.createElement("br")),a.appendChild(document.createElement("br")),a.append(d),t.appendChild(a);const r=document.createElement("div");r.style.position="sticky",r.id="item_container",r.style.padding="10px";const s=document.createElement("select");s.id="cat_select";const m=document.createElement("option");m.value="Uncategorized",m.text="Uncategorized";const p=document.createElement("label");p.id="cat_select_label",p.htmlFor="cat_select",p.textContent="Category to add to-do item to: ",s.appendChild(m);const u=document.createElement("input");u.id="item_input_name",u.type="text";const h=document.createElement("label");h.htmlFor="item_input_name",h.textContent="To-do item name: ";const C=document.createElement("input");C.id="item_input_due",C.type="date";const b=document.createElement("label");b.htmlFor="item_input_due",b.textContent="Due date: ";const g=document.createElement("select");g.id="priority_select";const E=document.createElement("option");E.value=0,E.text="Low";const y=document.createElement("option");y.value=1,y.text="Medium";const _=document.createElement("option");_.value=2,_.text="High";const v=document.createElement("label");v.id="priority_select_label",v.htmlFor="priority_select",v.textContent="Priority level: ";const x=document.createElement("button");x.classList.add("add_button"),x.id="item_button",x.textContent="Add new item!",g.appendChild(E),g.appendChild(y),g.appendChild(_);const f=document.createElement("textarea");f.id="panel_notes_input",f.rows="10",f.columns="40";const L=document.createElement("label");L.htmlFor="panel_notes_input",L.textContent="Notes on the item: ",r.appendChild(p),r.appendChild(document.createElement("br")),r.appendChild(s),r.appendChild(document.createElement("br")),r.appendChild(document.createElement("br")),r.appendChild(h),r.appendChild(document.createElement("br")),r.appendChild(u),r.appendChild(document.createElement("br")),r.appendChild(document.createElement("br")),r.appendChild(b),r.appendChild(document.createElement("br")),r.appendChild(C),r.appendChild(document.createElement("br")),r.appendChild(document.createElement("br")),r.appendChild(v),r.appendChild(document.createElement("br")),r.appendChild(g),r.appendChild(document.createElement("br")),r.appendChild(document.createElement("br")),r.appendChild(L),r.appendChild(document.createElement("br")),r.appendChild(f),r.appendChild(document.createElement("br")),r.appendChild(document.createElement("br")),r.appendChild(x),t.appendChild(r),x.addEventListener("click",n)})();const d=window.localStorage;if(0===d.length){const e=c("Uncategorized","This is the default, uncategorized category!",[]);a(e);const t=[e];d.setItem("arr",JSON.stringify(t))}else{const e=JSON.parse(d.getItem("arr"));console.log(e);for(let t of e){a(t);const e=t.items;for(let n of e)i(t.cat_name,n)}t()}})()})();